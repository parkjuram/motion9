{% extends "mobile_base.html" %}

{% load static %}
{% load humanize %}
{% load mathfilters %}

<!-- 
Template Name: Metronic - Responsive Admin Dashboard Template build with Twitter Bootstrap 3.3.1
Version: 3.6
Author: KeenThemes
Website: http://www.keenthemes.com/
Contact: support@keenthemes.com
Follow: www.twitter.com/keenthemes
Like: www.facebook.com/keenthemes
Purchase: http://themeforest.net/item/metronic-responsive-admin-dashboard-template/4021469?ref=keenthemes
License: You must have a valid license purchased only from themeforest(the above link) in order to legally use the theme for your project.
-->
<!--[if IE 8]> <html lang="en" class="ie8 no-js"> <![endif]-->
<!--[if IE 9]> <html lang="en" class="ie9 no-js"> <![endif]-->
<!--[if !IE]><!-->
<!--<![endif]-->
<!-- BEGIN HEAD -->
{% block header %}
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta content="width=device-width, initial-scale=1" name="viewport"/>
    <meta content="" name="description"/>
    <meta content="" name="author"/>

    <!-- BEGIN GLOBAL MANDATORY STYLES -->
    <link href="http://fonts.googleapis.com/css?family=Open+Sans:400,300,600,700&subset=all" rel="stylesheet"
          type="text/css"/>
    <link href="{% static 'metronic_assets/global/plugins/uniform/css/uniform.default.css' %}" rel="stylesheet"
          type="text/css"/>
    <!-- END GLOBAL MANDATORY STYLES -->
    <!-- BEGIN THEME STYLES -->
    <!-- DOC: To use 'rounded corners' style just load 'components-rounded.css' stylesheet instead of 'components.css' in the below style tag -->

    <link href="{% static 'metronic_assets/global/css/components.css' %}" id="style_components" rel="stylesheet"
          type="text/css"/>
    <link href="{% static 'metronic_assets/global/css/plugins.css' %}" id="style_components" rel="stylesheet"
          type="text/css"/>
    <link href="{% static 'metronic_assets/admin/layout4/css/layout.css' %}" rel="stylesheet" type="text/css"/>
    <link rel="stylesheet" href="{% static 'css/common_style.css' %}"/>
    <link rel="stylesheet" href="{% static 'css/survey2_result_style.css' %}"/>
    <!-- END THEME STYLES -->
    <link rel="shortcut icon" href="favicon.ico"/>
    <link rel="stylesheet" href="{% static 'css/bootstrap.min.css' %}"/>

    <script type="text/javascript">
        var urlForDoInterest = "{% url 'do_interest_product' %}";
        var urlForUndoInterest = "{% url 'undo_interest_product' %}";
        var urlForSurveyAgain = "{% url 'survey_again' %}"
    </script>

{% endblock %}

{% block title %}
    <div style="text-align:center; height:100%; margin-top:4px">
        <a href="{% url 'mobile:mobile_index' %}" target="_self">
            <img src="{% static "img/LOGO_black.png" %}" class="main-logo-img">
        </a>
    </div>
{% endblock %}

{% block content %}

    <!-- Modal -->

    <div class="modal fade" id="responsive" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"
         aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <div type="button" class="close" data-dismiss="modal" aria-label="Close"><span
                            aria-hidden="true">&times;</span></div>
                    <h4 class="modal-title" id="myModalLabel">재분석 요청</h4>

                    <div>분석이 완료되면 알림을 받을 수 있도록 옐로아이디를 등록해주세요</div>
                </div>
                <div class="modal-body">
                    <div class="lise-title">
                        재분석 요청 항목
                    </div>
                    <div class="form-group">
                        <div class="col-xs-12">
                            <div class="checkbox">
                                <input class="again-item" type="checkbox" value="all">
                                <span>전체 보고서 다시 요청</span>
                            </div>
                        </div>
                        {% for category in categories %}
                            {% if forloop.counter0 == 0 %}
                                <div class="col-xs-6">
                                    <div class="checkbox">
                                        <input class="again-item" type="checkbox" value="{{ category.name }}"><span>{{ category.name_for_kor }}</span>
                            {% elif forloop.counter0 == 4 %}
                                    </div>
                                </div>
                                <div class="col-xs-6">
                                    <div class="checkbox">
                                        <input class="again-item" type="checkbox" value="{{ category.name }}"><span>{{ category.name_for_kor }}</span>
                            {% elif forloop.last %}
                                        <input class="again-item" type="checkbox" value="{{ category.name }}"><span>{{ category.name_for_kor }}</span>
                                    </div>
                                </div>
                            {% else %}
                                <input class="again-item" type="checkbox" value="{{ category.name }}"><span>{{ category.name_for_kor }}</span>
                            {% endif %}
                        {% endfor %}
                    </div>
                    <div class="lise-title">
                        요청 이유
                    </div>
                    <div class="col-xs-12">
                        <textarea id="text-reason" class="form-control" rows="3">ex)추천된 로션은 유분기가 많아서 저에게 안맞는거 같아요</textarea>
                    </div>
                    <div class="lise-title">
                        추가 요청 사항
                    </div>
                    <div class="col-xs-12">
                        <textarea id="text-comments" class="form-control" rows="3">ex)폴라초이스 제품 위주로 추천해주세</textarea>
                    </div>
                </div>
                <div class="modal-footer">
                    <div type="button" class="btn btn-default" data-dismiss="modal">취소</div>
                    <div type="button" class="btn btn-primary btn-survey-again" user-survey-id="{{ request.pk }}" data-dismiss="modal">재분석 요청</div>
                </div>
            </div>
        </div>
    </div>

    <body style="background-color:#e6e9f2;">

    <div class="clearfix"></div>

    <!-- BEGIN CONTAINER -->
    <div class="page-container" style="background-color:#e6e9f2;">
        <!-- BEGIN CONTENT -->
        <div class="page-content">


            <!-- BEGIN PAGE HEAD -->
            <div class="page-head" style="margin-bottom:10px;">
                <!-- BEGIN PAGE TITLE -->
                <div class="page-title">
                    <h1 style="font-size:20px;">2014년 12월 20일 보고서</h1>
                    {#                         <small>부제목</small>#}
                </div>
                <!-- END PAGE TITLE -->
                <!-- BEGIN PAGE TOOLBAR -->
                <div class="page-toolbar">
                    <div type="button" class="btn btn-lg red"
                            style="background-color: #c63927 !important; font-size:11px; color:#FFFFFF !important;"
                            data-toggle="modal" data-target="#responsive">
                        {#                        <a href="{% url "mobile:survey2_result_detail" pk=request.pk product_type='skin' %}" data-rel="dialog" class="btn btn-lg red" style="font-size:11px; color:#FFFFFF !important;">#}
                        {#                            재분석 요청#}
                        {#                        </a>#}
                        재분석 요청
                    </div>
                </div>
                <!-- END PAGE TOOLBAR -->
            </div>
            <!-- END PAGE HEAD -->
            <!-- BEGIN PAGE CONTENT INNER -->

            <div class="row">
                <div class="wrapper">
                    <!-- BEGIN PORTLET-->
                    <div class="portlet light">
                        <div class="portlet-title">
                            <div class="caption caption-md">
                                <i class="icon-bar-chart theme-font-color hide"></i>
                                <span class="caption-subject theme-font-color bold uppercase">분석 총평</span>
                            </div>
                        </div>
                        <div class="portlet-body total-review">
                            {{ user_survey_result.general_review }}
                        </div>
                        <div id="sales_statistics" class="portlet-body-morris-fit morris-chart"
                             style="height: 260px; display:none;">
                        </div>
                    </div>
                    <!-- END PORTLET-->
                </div>
                <div class="wrapper">
                    <!-- BEGIN PORTLET-->
                    <div class="portlet light ">
                        <div class="portlet-title">
                            <div class="caption caption-md">
                                <i class="icon-bar-chart theme-font-color hide"></i>
                                <span class="caption-subject theme-font-color bold uppercase">예산</span>
                            </div>
                        </div>
                        <div class="tools">
                            <a href="javascript:;" class="collapse">
                            </a>
                            <a href="#portlet-config" data-toggle="modal" class="config">
                            </a>
                            <a href="javascript:;" class="reload">
                            </a>
                            <a href="javascript:;" class="remove">
                            </a>
                        </div>
                        <div class="portlet-body">
                            <h4>예산은 {{ user_survey_result.budget_min|intcomma }}
                                ~ {{ user_survey_result.budget_max|intcomma }}원 입니다.</h4>

                            <div id="chart_7" style="width: 90%; height:250px; font-size:14px;"></div>
                        </div>
                    </div>
                </div>
            </div>


            <!-- END PAGE TITLE -->

            {% for key, value in survey_result_detail.items %}
                <div class="wrapper-title" style="padding-right:0px; padding-left:0px;">
                    <a href="{% url "mobile:survey2_result_detail" pk=request.pk product_type=key %}" target="self">
                        <!--<div class="dashboard-stat green-meadow" style="margin-top:10px; margin-bottom:10px;">-->
                            <!--<div class="visual"><i class="fa fa-bar-chart-o"></i></div>-->
                            <div class="details">
                                <div class="number" style="margin-right:40px;">{{ value.0.product.category.name_for_kor }}</div>
                            <!--</div>-->
                            <div class="more">분석 보고서 보기<i class="m-icon-swapright m-icon-white"></i></div>
                        </div>
                    </a>
                </div>

                <div class="wrapper-item">
                {% for item in value %}
                    <div class="col-xs-6" style="padding-left: 5px; padding-right: 5px;">
                        <a href="{% url "mobile:survey2_result_detail" pk=request.pk product_type=key %}"
                           target="_self">
                            <div class="dashboard-stat2" style="padding-bottom:5px; margin-bottom:0px;">
                                <div class="row">
                                    <div class="col-xs-12" style="padding-right:5px; padding-left: 5px;">
                                        <div class="product-x-img" style="width:auto; text-align:center;">
                                            <img src="{% static 'img/test.jpg' %}" alt="" style="width:40px;"/>
                                        </div>
                                    </div>
                                    <div >
                                        <div class="display">
                                            <div class="number" style="font-size:10px;">
                                                <h3 class="font-blue"
                                                    style="font-size:11px;">{{ item.product.name }}</h3>
                                                <span>{{ item.product.price|intcomma }}원/{{ item.product.capacity }}{{ item.product.capacity_unit }}</span><br/>
                                                <span>({{ item.product.unit_price }}원/{{ item.product.capacity_unit }})</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </a>
                        <a href="#" class="btn blue btn-interest"
                           product-id="{{ item.product.id }}"
                           user-survey-id="{{ request.pk }}"
                           style="width: 100%; color: white !important;">
                            {% if item.product.is_interested %}
                                관심완료
                            {% else %}
                                관심하기
                                <i class="fa fa-plus"></i>
                            {% endif %}
                        </a>
                    </div>

                {% endfor %}
                </div>
            {% endfor %}
        </div>
    </div>

    <script src="{% static 'metronic_assets/global/plugins/bootstrap/js/bootstrap.min.js' %}"
            type="text/javascript"></script>
    <script src="{% static 'metronic_assets/global/plugins/jquery-slimscroll/jquery.slimscroll.min.js' %}"
            type="text/javascript"></script>
    <script src="{% static 'metronic_assets/global/scripts/metronic.js' %}" type="text/javascript"></script>
    <script type="text/javascript" src="http://cdn.amcharts.com/lib/3/amcharts.js"></script>
	<script type="text/javascript" src="http://cdn.amcharts.com/lib/3/pie.js"></script>
    <script>
        jQuery(document).ready(function () {
            Metronic.init(); // init metronic core componets

            var chart = AmCharts.makeChart("chart_7", {
                        "type": "pie",
                        "pathToImages": "http://cdn.amcharts.com/lib/3/images/",
                        "angle": 12,
                        "balloonText": "[[title]]<br><span style='font-size:14px'><b>[[value]]원</b> ([[percents]]%)</span>",
                        "depth3D": 10,
                        "radius": 70,
                        "baseColor": "#7070FF",
                        "labelTickAlpha": 0.63,
                        "marginBottom": 0,
                        "marginTop": 0,
                        "pullOutEffect": "elastic",
                        "startEffect": "easeOutSine",
                        "titleField": "category",
                        "valueField": "column-1",
                        "handDrawScatter": 0,
                        "handDrawThickness": 0,
                        "allLabels": [],
                        "balloon": {},
                        "legend": {
                            "align": "center",
                            "markerType": "circle",
                            "valueText": "[[value]]원"
                        },
                        "titles": [],
                        "dataProvider": [
                            {
                                "category": "스킨",
                                "column-1": "82800"
                            },
                            {
                                "category": "로션",
                                "column-1": "45000"
                            },
                            {
                                "category": "수분크림",
                                "column-1": "80888"
                            }
                        ]
                    }
            );


            $('.total-review').slimScroll({

                height: '250px',
                railVisible: true,
                alwaysVisible: true
            });
        });
    </script>

    <script src="{% static 'metronic_assets/admin/pages/scripts/ui-extended-modals.js' %}"></script>
    <script src="{% static 'user/js/survey.js' %}"></script>
    <script src="{% static 'user/js/interest_product.js' %}"></script>
    <!-- END JAVASCRIPTS -->
    </body>
{% endblock %}
<!-- END BODY -->
