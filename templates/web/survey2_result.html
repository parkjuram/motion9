{% extends "web_base.html" %}

{% load static %}
{% load humanize %}
{% load mathfilters %}

{% block header %}
    <meta content="" name="description"/>
    <meta content="" name="author"/>

    <link href="http://fonts.googleapis.com/css?family=Open+Sans:400,300,600,700&subset=all" rel="stylesheet"
          type="text/css"/>
    <link href="{% static 'metronic_assets/global/plugins/font-awesome/css/font-awesome.min.css' %}" rel="stylesheet"
          type="text/css"/>
    <link href="{% static 'metronic_assets/global/plugins/simple-line-icons/simple-line-icons.min.css' %}"
          rel="stylesheet" type="text/css"/>
    <link href="{% static 'metronic_assets/global/plugins/bootstrap/css/bootstrap.min.css' %}" rel="stylesheet"
          type="text/css"/>
    <link href="{% static 'metronic_assets/global/plugins/uniform/css/uniform.default.css' %}" rel="stylesheet"
          type="text/css"/>
    <link href="{% static 'metronic_assets/global/plugins/bootstrap-switch/css/bootstrap-switch.min.css' %}"
          rel="stylesheet" type="text/css"/>

    <link href="{% static 'metronic_assets/global/plugins/bootstrap-daterangepicker/daterangepicker-bs3.css' %}"
          rel="stylesheet" type="text/css"/>
    <link href="{% static 'metronic_assets/admin/pages/css/tasks.css' %}" rel="stylesheet" type="text/css"/>
    <link href="{% static 'metronic_assets/global/css/components-rounded.css' %}" id="style_components" rel="stylesheet"
          type="text/css"/>
    <link href="{% static 'metronic_assets/global/css/plugins.css' %}" rel="stylesheet" type="text/css"/>
    <link href="{% static 'metronic_assets/admin/layout4/css/layout.css' %}" rel="stylesheet" type="text/css"/>
    <link href="{% static 'metronic_assets/admin/layout4/css/themes/default.css' %}" rel="stylesheet" type="text/css"
          id="style_color"/>
    <link href="{% static 'metronic_assets/admin/layout4/css/custom.css' %}" rel="stylesheet" type="text/css"/>
    <link rel="stylesheet" href="{% static 'css/product_detail_web.css' %}"/>
    <link rel="stylesheet" href="{% static 'magnific_popup/magnific-popup.css' %}"/>
    {% block common_style_css %}
        <link rel="stylesheet" href="{% static "css/report_style_web.css" %}"/>
    {% endblock %}

    <script type="text/javascript">
        var urlForDoInterest = "{% url 'do_interest_product' %}";
    </script>

{% endblock %}

{% block content %}

    <body style="background-color:#e6e9f2;">

    <div class="clearfix"></div>
    <div class="page-container margin-top-40">
        <div class="page-content">
            <div class="page-head" style="margin-bottom:10px;">
                <div class="page-title">
                    <h1>{{ user_survey_result.created|date:"Y년 m월 d일 보고서" }}</h1>
                    {#<small>부제목</small>#}
                </div>
                <div class="page-toolbar">
                    <a href="javascript:;" class="btn btn-lg red" style="font-weight:bold;">
                        재분석 요청
                    </a>
                </div>
            </div>
            <div class="row">
                <div class="col-md-6 col-sm-6 col-xs-6">
                    <div class="portlet light">
                        <div class="portlet-title">
                            <div class="caption caption-md">
                                <i class="icon-bar-chart theme-font-color hide"></i>
                                <span class="caption-subject theme-font-color bold uppercase">분석 총평</span>
                            </div>
                        </div>
                        <div class="portlet-body total-review">
                            {{ user_survey_result.general_review }}
                        </div>
                        <div id="sales_statistics" class="portlet-body-morris-fit morris-chart"
                             style="height: 260px; display:none;">
                        </div>
                    </div>
                </div>
                <div class="col-md-6 col-sm-6 col-xs-6">
                    <div class="portlet light ">
                        <div class="portlet-title">
                            <div class="caption caption-md">
                                <i class="icon-bar-chart theme-font-color hide"></i>
                                <span class="caption-subject theme-font-color bold uppercase">예산</span>
                            </div>
                        </div>
                        <div class="portlet-body">
                            <h4>예산은 {{ user_survey_result.budget_min|intcomma }}
                                ~ {{ user_survey_result.budget_max|intcomma }}원 입니다.</h4>
                            <div id="chart_7" style="width: 90%; height:250px; font-size:14px;"></div>
                        </div>
                    </div>
                </div>
            </div>
            {% for key, value in survey_result_detail.items %}
                {% if forloop.counter0|divisibleby:2 %}
                    {% ifnotequal forloop.count0 0  %}
                        </div><div class="row">
                    {% else %}
                        <div class="row">
                    {% endifnotequal %}
                {% endif %}

                <div class="col-md-6 col-sm-6 col-xs-6">
                    <div class="portlet light">
                        <div class="portlet-title">
                            {#                            <a href="{% url "report_detail" product_id=22 %}" target="self">#}
                            <div class="dashboard-stat blue" style="margin-top:5px;">
                                <div class="visual">
                                    <i class="fa fa-bar-chart-o"></i>
                                </div>

                                <div class="details">
                                    <div class="number" style="margin-right:40px;">{{ value.0.product.category.name_for_kor }}</div>
                                </div>
                                <a class="more"
                                   href="{% url "survey2_result_detail" pk=request.pk product_type=key %}">
                                    분석 보고서 보기
                                    <i class="m-icon-swapright m-icon-white"></i>
                                </a>
                            </div>
                            {#                            </a>#}
                        </div>

                        <div class="row">
                            {% for item in value %}
                                <div class="col-sm-6 col-md-6 col-xs-6">
                                    <a href="{% url "survey2_result_detail" pk=request.pk product_type=key %}" target="_self">
                                        <div class="dashboard-stat2" style="min-height:330px;">
                                            <div class="display">
                                                <div class="number">
                                                    <h3 class="font-blue"
                                                        style="font-size:15px;">{{ item.product.name }}</h3>
                                                    <small style="float:right;">{{ item.product.price|intcomma }}원/{{ item.product.capacity }}{{ item.product.capacity_unit }}</small>
                                                </div>
                                            </div>
                                            <div class="product-x-img" style="bottom:15%; position:absolute;">
                                                <img src="{% static 'img/test.jpg' %}" alt=""/>
                                            </div>
                                        </div>
                                    </a>
                                    <a href="#" class="btn btn-lg blue btn-interest"
                                       product-id="{{ item.product.id }}"
                                       user-survey-id="{{ request.pk }}"
                                       style="width: 100%;">
                                        {% if item.product.is_interested %}
                                            관심완료
                                        {% else %}
                                            관심하기
                                            <i class="fa fa-plus"></i>
                                        {% endif %}
                                    </a>
                                </div>
                            {% endfor %}
                        </div>
                    </div>
                </div>

                {% if forloop.last %}
                    </div>
                {% endif %}
            {% endfor %}

            <!-- END PAGE TITLE -->

        </div>


        <!-- END PAGE CONTENT INNER -->
    </div>
    <!-- END CONTENT -->
    </div>
    <!-- END CONTAINER -->
    <!-- BEGIN JAVASCRIPTS(Load javascripts at bottom, this will reduce page load time) -->
    <!-- BEGIN CORE PLUGINS -->
    <!--[if lt IE 9]>
	<script src="{% static 'metronic_assets/global/plugins/respond.min.js' %}"></script>
	<script src="{% static 'metronic_assets/global/plugins/excanvas.min.js' %}"></script>

	<![endif]-->

    <script src="{% static 'metronic_assets/global/plugins/jquery-migrate.min.js' %}" type="text/javascript"></script>

    <script src="{% static 'metronic_assets/global/plugins/jquery-ui/jquery-ui-1.10.3.custom.min.js' %}"
            type="text/javascript"></script>
    <script src="{% static 'metronic_assets/global/plugins/bootstrap/js/bootstrap.min.js' %}"
            type="text/javascript"></script>
    <script src="{% static 'metronic_assets/global/plugins/bootstrap-hover-dropdown/bootstrap-hover-dropdown.min.js' %}"
            type="text/javascript"></script>
    <script src="{% static 'metronic_assets/global/plugins/jquery-slimscroll/jquery.slimscroll.min.js' %}"
            type="text/javascript"></script>
    <script src="{% static 'metronic_assets/global/plugins/jquery.blockui.min.js' %}" type="text/javascript"></script>
    <script src="{% static 'metronic_assets/global/plugins/jquery.cokie.min.js' %}" type="text/javascript"></script>
    <script src="{% static 'metronic_assets/global/plugins/uniform/jquery.uniform.min.js' %}"
            type="text/javascript"></script>
    <script src="{% static 'metronic_assets/global/plugins/bootstrap-switch/js/bootstrap-switch.min.js' %}"
            type="text/javascript"></script>

    <script src="{% static 'metronic_assets/global/plugins/morris/morris.min.js' %}" type="text/javascript"></script>
    <script src="{% static 'metronic_assets/global/plugins/morris/raphael-min.js' %}" type="text/javascript"></script>
    <script src="{% static 'metronic_assets/global/plugins/jquery.sparkline.min.js' %}" type="text/javascript"></script>

    <script src="{% static 'metronic_assets/global/scripts/metronic.js' %}" type="text/javascript"></script>
    <script src="{% static 'metronic_assets/admin/layout4/scripts/layout.js' %}" type="text/javascript"></script>
    <script src="{% static 'metronic_assets/admin/layout4/scripts/demo.js' %}" type="text/javascript"></script>
    <script src="{% static 'metronic_assets/admin/pages/scripts/index3.js' %}" type="text/javascript"></script>
    <script src="{% static 'metronic_assets/admin/pages/scripts/tasks.js' %}" type="text/javascript"></script>

    <script src="{% static 'metronic_assets/admin/layout3/scripts/layout.js' %}" type="text/javascript"></script>
    <script src="{% static 'metronic_assets/admin/layout3/scripts/demo.js' %}" type="text/javascript"></script>
    <script src="{% static 'metronic_assets/admin/pages/scripts/charts-flotcharts.js' %}"></script>

    <script src="{% static 'metronic_assets/global/plugins/amcharts/amcharts/amcharts.js' %}"></script>
    <script src="{% static 'metronic_assets/global/plugins/amcharts/amcharts/pie.js' %}"></script>
    <script src="{% static 'metronic_assets/global/plugins/amcharts/amcharts/themes/light.js' %}"></script>

    <script>
        jQuery(document).ready(function () {
            Metronic.init(); // init metronic core componets
            Layout.init(); // init layout
            Demo.init(); // init demo features
            Index.init(); // init index page
            Tasks.initDashboardWidget(); // init tash dashboard widget

            var chart_data = {{ chart_data|safe }};
            for( var item in chart_data ) {
                chart_data[item]['category'] = decodeURIComponent(escape(chart_data[item]['category']));
            }

            var chart = AmCharts.makeChart("chart_7", {
                "type": "pie",
                "theme": "light",
                "dataProvider": chart_data,
                "valueField": "value",
                "titleField": "category",
                "outlineAlpha": 0.4,
                "depth3D": 15,
                "balloonText": "[[title]]<br><span style='font-size:14px'><b>[[value]] 원</b> ([[percents]]%)</span>",
                "angle": 30,
                "exportConfig": {
                    menuItems: [{
                        icon: '/lib/3/images/export.png',
                        format: 'png'
                    }]
                }
            });


            $('.total-review').slimScroll({

                height: '250px',
                railVisible: true,
                alwaysVisible: true
            });
        });
    </script>

    <script src="{% static 'user/js/interest_product.js' %}"></script>

    </body>
{% endblock %}
